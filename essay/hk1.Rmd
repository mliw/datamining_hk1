---
title: "ECO395M STAT LEARNING Homework 1" 
author: "Mingwei Li, Xinyu Leng, Hongjin Long"
thanks: "Mingwei Li, Xinyu Leng and Hongjin Long are master students of economics, The University of Texas at Austin"
output:
  pdf_document: 
    number_sections: yes
  html_document: default
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

\begin{abstract}
This document is the first homework of ECO395M STAT LEARNING. The projects \textbf{Gas Price}, \textbf{a bike share network}, \textbf{flights at ABIA} and \textbf{K-nearest neighbors} are included in this document. The whole project is available at \textcolor{blue}{\href{https://github.com/mliw/datamining_hk1}{here}}. 
\begin{figure}[!htbp]
	\centering
	\includegraphics[width=0.85\textwidth]{pic/0.jpg}
\end{figure}

\end{abstract}

\newpage
\tableofcontents

\newpage
\section{Gas Price}
```{r, echo=FALSE,message=FALSE}
gasprice = read.csv("data/GasPrices.csv")
library(ggplot2)
library(tidyverse)
```

\textbf{(A) Gas stations charge more if they lack direct competition in sight (boxplot).}

```{r fig1, fig.width=4,fig.height=4,fig.align = "center",echo=TRUE}
p0 = ggplot(data=gasprice) + 
  geom_boxplot(aes(x=Competitors, y=Price))
p0
```
\textbf{Claim}: Gas stations charge more if they lack direct competition in sight

\textbf{Conclusion}: The theory is supported by the data. As the left box is higher than the right box.

\newpage
\textbf{(B) The richer the area, the higher the gas price (scatter plot).}

```{r fig2, fig.width=4,fig.height=4,fig.align = "center",echo=TRUE}
p0 = ggplot(data=gasprice) + 
  geom_point(aes(x=Income, y=Price))
p0
```
\textbf{Claim}: The richer the area, the higher the gas price

\textbf{Conclusion}: The theory is supported by the data. As the points in the figure show an increasing trend(this trend not very clear).

\newpage
\textbf{(C) Shell charges more than other brands (bar plot).}

```{r fig3, fig.width=4,fig.height=4,fig.align = "center",echo=TRUE}
d4 = gasprice %>%
  group_by(Brand) %>%
  summarize(mean_price=mean(Price))
p0 = ggplot(data=d4) + 
  geom_col(aes(x=Brand, y=mean_price))
p0 + coord_cartesian(ylim =c(min(d4$mean_price)*0.8, max(d4$mean_price)))
```

\textbf{Claim}: Shell charges more than other brands

\textbf{Conclusion}: The theory is supported by the data. As the bar of Shell is the highest (the same as ChevronTexaco).


\newpage
\textbf{(D) Gas stations at stoplights charge more (faceted histogram).}

```{r fig4, fig.width=4, fig.height=4,fig.align = "center",echo=TRUE}
p0 = ggplot(data=gasprice) + 
  geom_histogram(aes(x=Price, after_stat(density)),binwidth=0.02) + 
  facet_wrap(~Stoplight)
p0
```

\textbf{Claim}: Gas stations at stoplights charge more

\textbf{Conclusion}: The theory is supported by the data. As more density is put on the right tail of gas stations at stoplights(However, the graph is not very clear in this problem)


\newpage
\textbf{(E) Gas stations with direct highway access charge more (your choice of plot).}

faceted histogram and boxplot are used to solve this problem.

\textbf{(1)faceted histogram:}
```{r fig5, fig.width=3, fig.height=3,fig.align = "center",echo=TRUE}
p0 = ggplot(data=gasprice) + 
  geom_histogram(aes(x=Price, after_stat(density)),binwidth=0.02) + 
  facet_wrap(~Highway)
p0
```

\textbf{(2)boxplot:}
```{r fig6, fig.width=2.5, fig.height=2.5,fig.align = "center",echo=TRUE}
p0 = ggplot(data=gasprice) + 
  geom_boxplot(aes(x=Highway, y=Price))
p0
```

\textbf{Claim}: Gas stations with direct highway access charge more

\textbf{Conclusion}: The theory is supported by the data. As in histogram, more density is put on the right tail of gas stations with direct highway access. The boxplot reaches the same conclusion.

\section{a bike share network}
```{r, echo=FALSE,message=FALSE,results='hide'}
library(tidyverse)
library(ggplot2)
bikeshare=read.csv("data/bikeshare.csv")
head(bikeshare, 10)
```

\textbf{(a) Plot A: a line graph showing average bike rentals (total) versus hour of the day (hr).}

```{r fig7, fig.width=2.5, fig.height=2.5,fig.align = "center",echo=TRUE}
avg_hr_rent=bikeshare %>%
  group_by(hr) %>%
  summarize(avg_hour_rental=mean(total))
ggplot(data=avg_hr_rent) + 
  geom_line(aes(x=hr, y=avg_hour_rental)) +
  scale_x_continuous(breaks=0:23)
```

\textbf{(b) Plot B: a faceted line graph showing average bike rentals versus hour of the day, faceted according to whether it is a working day (workingday).}
```{r fig8, fig.width=2.5, fig.height=2.5,fig.align = "center",echo=TRUE,message=FALSE,results='hide'}
avg_hr_work_rent=bikeshare %>%
  group_by(hr, workingday) %>%
  summarize(avg_hour_working_rental=mean(total))
ggplot(data=avg_hr_work_rent) + 
  geom_line(aes(x=hr, y=avg_hour_working_rental)) +
  scale_x_continuous(breaks=0:23) +
  facet_wrap(~ workingday, nrow=2)
```

\newpage
\textbf{(c) Plot C: a faceted bar plot showing average ridership during the 8 AM hour by weather situation code (weathersit), faceted according to whether it is a working day or not.}

```{r fig9, fig.width=2.5, fig.height=2.5,fig.align = "center",echo=TRUE,message=FALSE,results='hide'}
bikeshare_8am=bikeshare %>%
  filter(hr==8)
bike_8am_work_wather= bikeshare_8am %>%
  group_by(workingday, weathersit) %>%
  summarise(avg_8am_working_wather=mean(total))
ggplot(data=bike_8am_work_wather) + 
  geom_col(aes(x=weathersit, y=avg_8am_working_wather)) +
  facet_wrap(~ workingday, nrow=2)
``` 
  
  
  